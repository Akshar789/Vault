# =============================================================================
# ZERO-KNOWLEDGE VAULT - ENVIRONMENT CONFIGURATION
# =============================================================================
# SECURITY: Never commit actual .env files to version control
# Generate secrets with: openssl rand -base64 32

# =============================================================================
# ENVIRONMENT
# =============================================================================
NODE_ENV=development
PORT=3001

# =============================================================================
# SUPABASE POSTGRESQL (REQUIRED)
# =============================================================================
# Get from: https://app.supabase.com/project/_/settings/database
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:5432/postgres
DIRECT_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:5432/postgres

# Connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10

# =============================================================================
# UPSTASH REDIS (REQUIRED)
# =============================================================================
# Get from: https://console.upstash.com/
REDIS_URL=rediss://default:[YOUR-PASSWORD]@[YOUR-ENDPOINT].upstash.io:6379

# =============================================================================
# JWT SECRETS (GENERATE UNIQUE VALUES)
# =============================================================================
# Generate with: openssl rand -base64 64
JWT_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64
JWT_REFRESH_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64

# Token expiration
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# =============================================================================
# ARGON2ID PARAMETERS (TUNABLE FOR PERFORMANCE/SECURITY TRADEOFF)
# =============================================================================
# Memory cost in KB (64MB = 65536 KB)
ARGON2_MEMORY=65536

# Time cost (iterations)
ARGON2_TIME=3

# Parallelism (threads)
ARGON2_PARALLELISM=4

# Hash length in bytes
ARGON2_HASH_LENGTH=32

# =============================================================================
# RATE LIMITING
# =============================================================================
# Global rate limit (requests per window)
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=900000

# Login rate limit (more restrictive)
LOGIN_RATE_LIMIT_MAX=5
LOGIN_RATE_LIMIT_WINDOW_MS=900000

# Registration rate limit
REGISTER_RATE_LIMIT_MAX=3
REGISTER_RATE_LIMIT_WINDOW_MS=3600000

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Account lockout after failed login attempts
MAX_FAILED_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MS=900000

# Maximum devices per user
MAX_DEVICES_PER_USER=10

# Session timeout (milliseconds)
SESSION_TIMEOUT_MS=86400000

# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com

# =============================================================================
# FRONTEND (Next.js)
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:3001
NEXT_PUBLIC_APP_URL=http://localhost:3000

# =============================================================================
# FLY.IO DEPLOYMENT (PRODUCTION)
# =============================================================================
# Fly.io app name
FLY_APP_NAME=your-vault-app

# Fly.io region
FLY_REGION=iad

# =============================================================================
# MONITORING & LOGGING
# =============================================================================
# Log level: error, warn, info, debug
LOG_LEVEL=info

# Sentry DSN (optional)
SENTRY_DSN=

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# Enable 2FA
ENABLE_2FA=true

# Enable audit logging
ENABLE_AUDIT_LOGS=true

# Enable offline mode (IndexedDB cache)
ENABLE_OFFLINE_MODE=true

# =============================================================================
# DEVELOPMENT ONLY
# =============================================================================
# Skip email verification in development
DEV_SKIP_EMAIL_VERIFICATION=true

# Mock 2FA in development
DEV_MOCK_2FA=false
